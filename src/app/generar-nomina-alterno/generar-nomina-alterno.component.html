<div class="container">
	<div class="row">
		<div class="col-12">
			<h1>Producción por Área</h1>
		</div>
	</div>
	<form (submit)="submitSearch($event)" ngNativeValidate>
		<div class="row">
			<div class="col-12 col-md-4">
				<div class="form-group">
					<label for="production_area">Area de producción</label>
					<select class="form-control" name="production_area_id" id="production_area_id" [(ngModel)]="production_area_id" required>
						<option value="">Seleccionar</option>
						@for (area of production_area_list; track area.id)
						{
							<option [ngValue]="area.id">{{area.name}}</option>
						}
					</select>
				</div>
			</div>
			<div class="col-12 col-md-4">
				<label for="start_date">Desde</label>
				<input type="date" class="form-control" name="start_date" id="start_date" [(ngModel)]="start_date" required>
			</div>

			<div class="col-12 col-md-4">
				<label for="end_date">Hasta</label>
				<input type="date" class="form-control" name="end_date" id="end_date" [(ngModel)]="end_date" required>
			</div>
			<div class="col-12 col-md-4">
				<button type="submit" class="btn btn-primary">Buscar</button>
			</div>
		</div>
	</form>

  <h2>Consumos</h2>

	<div class="row titulo-subheader">
		<div class="col-12 col-md-3"></div>
		<div class="col-12 col-md-3">Precio</div>
		<div class="col-12 col-md-3 text-end">Litros</div>
		<div class="col-12 col-md-3 text-end">Total</div>
	</div>

	@for (consumption_info of consumption_info_list; track consumption_info.consumption.id; let index = $index)
	{
		<div class="row gasolina">
			<div class="col-12 col-md-3">
				{{consumption_info.item.name}} ({{consumption_info.consumption.consumed | shortDate}})
			</div>
			<div class="col-12 col-md-3">
				{{consumption_info.consumption.price}}
			</div>
			<div class="col-12 col-md-3 text-end">
				{{consumption_info.consumption.qty}}
			</div>
			<div class="col-12 col-md-3 text-end">
				{{consumption_info.consumption.price * consumption_info.consumption.qty | currency:'$' }}
			</div>
		</div>
	}

  <div *ngFor="let up of user_production_list">
    <h3>{{ up.user.name }}</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Description</th>
          <th>Date</th>
          <th class="text-end">Qty</th>
          <th class="text-end">Price</th>
          <th class="text-end">Total</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let item of up.items">
          <tr *ngFor="let d of item.dates">
            <td>{{ item.item.name }}</td>
            <td>{{ d.date | shortDate }}</td>
            <td class="text-end">{{ d.qty | number:'1.2-2' }}</td>
            <td class="text-end">{{ d.price | currency:'$' }}</td>
            <td class="text-end">{{ d.total | currency:'$' }}</td>
          </tr>
        </ng-container>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="4" class="text-end"><strong>Total del usuario:</strong></td>
          <td class="text-end"><strong>{{ up.total_amount | currency:'$' }}</strong></td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>