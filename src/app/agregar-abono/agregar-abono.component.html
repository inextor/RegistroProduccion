<div class="container mt-4">
  <div *ngIf="is_loading" class="loading-indicator">Cargando...</div>

  <div *ngIf="!is_loading">
    <h2>Agregar Abono para {{ user.name }}</h2>
    <p class="alert alert-info" *ngIf="accounts.length > 0">
      <strong>Saldo Actual:</strong> {{ getCurrentBalance() | currency:'USD':'symbol':'1.2-2' }}
    </p>

    <form (ngSubmit)="onGuardar()">
      <div class="form-group">
        <label for="description">Descripci√≥n</label>
        <input type="text" id="description" name="description" class="form-control" [(ngModel)]="description" required>
      </div>

      <div class="form-group">
        <label for="amount">Monto</label>
        <input type="number" id="amount" name="amount" class="form-control" [(ngModel)]="amount" required>
      </div>

      <div class="form-group">
        <label for="date">Fecha</label>
        <input type="date" id="date" name="date" class="form-control" [(ngModel)]="date" required>
      </div>

      <div class="form-group" *ngIf="show_account_selector">
        <label for="account">Cuenta</label>
        <select id="account" name="account" class="form-control" [(ngModel)]="selected_account_id" (ngModelChange)="onAccountChange()" required>
          <option *ngFor="let account of accounts" [value]="account.id">
            {{ account.currency_id }} - Balance: {{ account.balance | currency:'USD':'symbol':'1.2-2' }}
            <span *ngIf="account.is_main">(Principal)</span>
          </option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary">Guardar</button>
    </form>
  </div>
</div>
